setup:
	go get -u golang.org/x/tools/cmd/goimports

build-all: fmt
	go install ./...
	go test -i ./...

build-all-race: fmt
	go install -race ./...
	go test -i -race ./...

fmt:
	gofmt -w=true -s $$(find . -type f -name '*.go')
	goimports -w=true -d $$(find . -type f -name '*.go')

test-race: fmt
	go test -i -race ./...
	go test -race ./...

test: fmt
	go test -i ./...
	go test ./...
